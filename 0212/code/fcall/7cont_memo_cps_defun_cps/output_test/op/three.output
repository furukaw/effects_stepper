Step 0:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) (with (handler {return x -> x, B(x; k) -> (k x)}) handle ((fun c -> c) (with (handler {return x -> x, C(x; k) -> (k x)}) handle ((B (fun d -> d)) (fun e -> e))))))))
Step 1:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) ((fun y => (with (handler {return x -> x, B(x; k) -> (k x)}) handle ((fun c -> c) (with (handler {return x -> x, C(x; k) -> (k x)}) handle (y (fun e -> e)))))) (fun d -> d)))))
Step 1:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) ((fun y => (with (handler {return x -> x, B(x; k) -> (k x)}) handle ((fun c -> c) (with (handler {return x -> x, C(x; k) -> (k x)}) handle (y (fun e -> e)))))) (fun d -> d)))))
Step 2:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) (with (handler {return x -> x, B(x; k) -> (k x)}) handle ((fun c -> c) (with (handler {return x -> x, C(x; k) -> (k x)}) handle ((fun d -> d) (fun e -> e))))))))
Step 2:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) (with (handler {return x -> x, B(x; k) -> (k x)}) handle ((fun c -> c) (with (handler {return x -> x, C(x; k) -> (k x)}) handle ((fun d -> d) (fun e -> e))))))))
Step 3:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) (with (handler {return x -> x, B(x; k) -> (k x)}) handle ((fun c -> c) (with (handler {return x -> x, C(x; k) -> (k x)}) handle (fun e -> e)))))))
Step 3:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) (with (handler {return x -> x, B(x; k) -> (k x)}) handle ((fun c -> c) (with (handler {return x -> x, C(x; k) -> (k x)}) handle (fun e -> e)))))))
Step 4:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) (with (handler {return x -> x, B(x; k) -> (k x)}) handle ((fun c -> c) (fun e -> e))))))
Step 4:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) (with (handler {return x -> x, B(x; k) -> (k x)}) handle ((fun c -> c) (fun e -> e))))))
Step 5:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) (with (handler {return x -> x, B(x; k) -> (k x)}) handle (fun e -> e)))))
Step 5:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) (with (handler {return x -> x, B(x; k) -> (k x)}) handle (fun e -> e)))))
Step 6:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) (fun e -> e))))
Step 6:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle ((fun b -> b) (fun e -> e))))
Step 7:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle (fun e -> e)))
Step 7:  ((fun a -> a) (with (handler {return x -> x, A(x; k) -> (k x)}) handle (fun e -> e)))
Step 8:  ((fun a -> a) (fun e -> e))
Step 8:  ((fun a -> a) (fun e -> e))
Step 9:  (fun e -> e)
Result:  (fun e -> e)
